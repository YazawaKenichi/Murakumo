回路設計時のノート

いろいろ悩みそうなところだけど、どこから悩めばいいのかもわからなかったので、まずはモータドライバ回路から設計しようと思う。

モータドライバ設計の前に、H ブリッジを駆動するためのゲートドライバ選びについて記述する。
##### ゲートドライバ
まず、ゲートドライバに必要な要素は以下の通り。
- Nch フルブリッジ回路を組むことができるか？
- 100% duty で出力できるか？
ということらしい。

###### Nch フルブリッジ回路
Nch フルブリッジ回路を組むことの利点は以下。
- Pch は Nch に比べて性能が低い。
- Pch は品種があまりない。
- パワー素子は一種類のみで済ませて手間を省きたい。（Pch か Nch にそろえて同じ素子を使って製作できるようにしたい。）
- Pch は値段が高い。
上記理由を先輩に教えていただいたが、教えていただいた後にネットを探したところ、同様の記述を発見した。[参考](http://blog.livedoor.jp/wata_net/archives/2147292.html)。
[こっちのサイト](https://qiita.com/panzakii/items/97eca16954d34ecf0c8b)には「なぜフルNchにこだわるかというと、単純にその方が流せる電流が大きくなるからです。実はPchFETはNchFETに比べ流せる電流が少ないのです。原理について説明しだすと本当にキリがないので説明しません。興味のある人はググってください。」などと記述されているが、ググってもそんな記述は一切出てこない。なんなんだ。

「品種が多いから Pch よりも大電流の流せる Nch MOSFET」ならわかるが、「原理」とか「説明しだすとキリがない」とか記述されているのは本当に意味が分からない。

###### 100% duty で出力
- 最大出力で出せたほうが良いにきまっとるやろ！

二つのメリットをカバーできて、より入手しやすい IC が A3921 だそうで、それが理由でよく利用される。

##### モータドライバ
ゲートドライバが決まったところで、次に使用する FET とそれにつながる制限抵抗やコンデンサの値を決める必要がある。
特にこの抵抗とコンデンサは真剣に決めないとショートしてリポが死ぬ。マジで。
モータに入る電流は最大でも 4.34A なので、この許容電流に耐えうるケーブルは AWG22 になる。（AWG23 がいい感じに 4.7A の許容電流なのだが、9号館にないのでしょうがない。）
この AWG23 を圧着できるコネクタが XA コネクタなので、モータの電流が通るところのコネクタはすべて XA にしようと思う。
電源コネクタと電源回路をモータドライバ回路の方に設置することで、わざわざマイコン側から電力をモータドライバ回路に送る必要を無くす。

***書き途中***

DRV8874 のデータシートを読んで得た情報
- CPH CPL 間に 22nF のコンデンサ
- nFault は故障で LOW nSleep は LOW でスリープ => nFault と nSleep を直結すると故障と同時にスリープに入る。
- nFault には外部プルアップが必要。
- 


##### CPU
先輩が STM32F405RGT6 を束買いしているので、とりあえずこれにするのはアリ。
クロック数とメモリと機能的に、ロボトレにいい塩梅で使えそうなのがこの CPU らしい。

***書き途中***

##### 電源回路
この電源回路を決めるのにレギュレータを選ぶ必要があるのだが、レギュレータの出力が決まらない以上は手の付けようがない。だからさっさとほかの回路作れ。電源選びは最後だ。
=======
回路設計時のノート

いろいろ悩みそうなところだけど、どこから悩めばいいのかもわからなかったので、まずはモータドライバ回路から設計しようと思う。

使いたいモータがある -> 必要な電流量に耐える FET -> それを駆動できるゲートドライバを探す<br>
使いたいセンサがある -> 

モータドライバ設計の前に、H ブリッジを駆動するためのゲートドライバ選びについて記述する。
##### ゲートドライバ
まず、ゲートドライバに必要な要素は以下の通り。
- Nch フルブリッジ回路を組むことができるか？
- 100% duty で出力できるか？
ということらしい。

###### Nch フルブリッジ回路
Nch フルブリッジ回路を組むことの利点は以下。
- Pch は Nch に比べて性能が低い。
- Pch は品種があまりない。
- パワー素子は一種類のみで済ませて手間を省きたい。（Pch か Nch にそろえて同じ素子を使って製作できるようにしたい。）
- Pch は値段が高い。
上記理由を先輩に教えていただいたが、教えていただいた後にネットを探したところ、同様の記述を発見した。[参考](http://blog.livedoor.jp/wata_net/archives/2147292.html)。
[こっちのサイト](https://qiita.com/panzakii/items/97eca16954d34ecf0c8b)には「なぜフルNchにこだわるかというと、単純にその方が流せる電流が大きくなるからです。実はPchFETはNchFETに比べ流せる電流が少ないのです。原理について説明しだすと本当にキリがないので説明しません。興味のある人はググってください。」などと記述されているが、ググってもそんな記述は一切出てこない。なんなんだ。

「品種が多いから Pch よりも大電流の流せる Nch MOSFET」ならわかるが、「原理」とか「説明しだすとキリがない」とか記述されているのは本当に意味が分からない。

###### 100% duty で出力
- 最大出力で出せたほうが良いにきまっとるやろ！
100% duty で出せるかどうかってどうやって決まるんだろう...

二つのメリットをカバーできて、より入手しやすい IC が A3921 だそうで、それが理由でよく利用される。
A3921 の仕様
ゲート電圧は基準電位から +15V 以内の範囲が出力される様子。具体的には、ハイサイド出力が SA の電位よりも 0 ~ 15V 高くなり、ローサイド出力が GND 電位よりも -5 ~ 16V 高くなるように出力される。

A3921 のデータシートを読んで得た情報
- GHA and GHB Pins
- ゲート抵抗はできるだけ FET に近いところに置く必要がある。（なんでや）
- ＞ そもそもゲート抵抗をつける理由として
- ＞＞ FET 内部のコンデンサ成分と、導線自体によるインダクタンス成分が共振し、それに影響して FET やマイコンが破損する恐れがある。
- ＞＞ ドレイン電圧の立ち上がりと立下りが早すぎてノイズへの影響が大きくなる。
- ＞＞ ゲート電流が大きすぎて FET 前段の制御回路が破損する。
- ＞ この中で FET と抵抗の距離と関係がありそうな理由としては「導線自体のインダクタンス」だろう。抵抗からFETまでの導線の長さを小さくする、すなわちインダクタンスを小さくすることでノイズを軽減するといったところか。
- いまいちよくわからないところが、「GHx going low turns on the lower half of the drive, sinking current from the external FET gate circuit to the corresponding Sx pin, turning off the FET.」の一文で、GHx を Low にしたらドライブの下半分が ON になる？ってどういうことだ？
- Bootstrap Capacitor Selection
- ブートストラップコンデンサ CBOOTx は、正しく選択する必要がある。
- コンデンサの静電容量が大きいと、コンデンサの充電に時間が浪費され、結果として最大デューティーサイクルと PWM 周波数の制限が小さくなってしまう。
- 逆に小さいと、Charge Sharing によって、電荷が CBOOTx から FET ゲートに転送されるときに大きな電圧降下が発生する可能性があるらしい。
- ＞ Charge Sharing ってなんだ？
- ＞＞ 英語版 Wiki によると、Charge Sharing は、ある電子ドメインからほかの電子ドメインへの電荷の移動による信号劣化の影響。らしい。は？
- ＞ よくわからないけど、とにかく電荷を共有して、出力電圧レベルが退化したり、誤った出力値が発生したりする可能性があるっぽい。
- この電圧降下を小さくするために、CBOOTx の電荷 QBOOT は、FET のゲート QGATE に必要な電荷よりもはるかに大きくする必要がある。その"はるかに大きい"というのは、20 倍だそうだ。
- QBOOT というのは、CBOOTx に蓄えられる電気量なので、CBOOT * VBOOT で求めることができる。そして上記より、これは QGATE の 20 である必要があるので、ブートストラップに接続するコンデンサの、適切な電気容量 CBOOT を求める式は、以下のようになる。
[](url)- CBOOT = QGATE * 20 / VBOOT
- 係数 20 を選択した場合、FET が ON の時の VBOOT と OFF の時の VBOOT の差は約 5% だそう。通常動作条件下での VBOOT の最大電圧は VREG らしい。
- ＞ VREG の値について。。。疑問がある。
- ＞＞ Terminal List には Regulated 13V と説明があるのに、
- VBB 電源が 16V より大きいとき、レギュレータは単純なリニアレギュレータとなる。16V 未満では、安定したレギュレートをするために、ポンプコンデンサ CP が必要。
- このコンデンサ CP の最小値は 220nF である必要があり、通常は 470nF を接続する。
- 安定してレギュレートされた 13V は VREG 端子で使用できる。ローサイドドライブとブートストラップコンデンサに過渡充電電流を供給するために十分大きなストレージコンデンサを接続する必要がある。
参考になったサイト
- ハイサイド Nch MOSFET の話やブートストラップ回りについては[このサイト](https://techweb.rohm.co.jp/knowledge/dcdc/dcdc_sr/dcdc_sr01/829)が参考になった。

###### duty rate
[このサイト](https://sgrsn1711.hatenablog.com/entry/2019/04/29/152425)が参考になった。<br>
PWM 制御は PWM パルス波を用いて電圧を制御する方法。しかし **『PWM のデューティー比を線形に動かしても電圧は線形』にならない。** <br>
具体的な式は (実効値) = (最大瞬時値) * √(デューティー比)<br>
最大瞬時値：パルス波が HIGH の時の電圧<br>
デューティー比：そのままの意味（但し 0 以上 1 以下）<br>
実効値：PWM の電圧・電流をこれと同じ働きをする直流の電圧・電流の大きさに置き換えて表した値<br>
両辺を二乗して両辺を (モータの抵抗) で割ると<br>
(実効電圧) / (モータの抵抗) = (デューティー比) * (最大瞬時電圧) / (モータの抵抗)<br>
すなわち<br>
(実効電力) = (デューティー比) * (ドライバの電力)<br>
となり、**(デューティー比) は 電力 の比例定数となっている**ことがわかる。<br>
<br>
[このサイト](https://detail-infomation.com/gate-driver-type/)によると、ターンオンを速くする回路よりもターンオフを速くする回路の方が頻繁に用いられるらしい。たしかに、4月に制作したミニトレーサ回路も、ターンオフが速くなる方向にダイオードが設けられていた。ターンオフ抵抗が小さいので、MOSFET のミラー容量を介して誤ターンオンを防ぐことができるようだ。

##### モータドライバ
ゲートドライバが決まったところで、次に使用する FET とそれにつながる制限抵抗やコンデンサの値を決める必要がある。
特にこの抵抗とコンデンサは真剣に決めないとショートしてリポが死ぬ。マジで。

参考までに先輩のデータを置いておく。
DRV8874 (野村先輩)
DRV8873 + INA260 (井口先輩青機体)
DRV8701 + AON7xxx (井口先輩紫機体)
A3921 + IRF8915 (下鳥先輩 VCM 機体)

H ブリッジが組める IC を Digi-Key で探したが、どうやら今は在庫切れっぽい。は？どうすりゃいいの？
- パターン１：ほかのサイトでも探してみる
- パターン２：H ブリッジを自作する
- パターン３：何？

Digi-Key で在庫を無視して H ブリッジを絞り込んで、当然というか、上記の通り在庫がないので Mouser で検索していく。
- [L9958](https://www.mouser.jp/ProductDetail/STMicroelectronics/L9958?qs=mxm%2FV7p14IPZ8VUmCRyJ0Q%3D%3D) が良さそう。電圧と必要な電流で絞り込んだら L9958 うんたら～みたいなのがたくさん出てきたが、データシートは同じものだったので、データシートを読む分にはどれを選んでも大丈夫そう。電流制限機能があり、CL ピンに設定する H/L でその閾値を決めているようだ。実際に通す電流は 5A 行かないくらいなので、制限 8A で十分である。L9958 うんたら～を絞るのはどうすればよいのだろう... 何が違うのかをデータシートから読む必要がありそう。また、消費電力を計算してこの IC で良いかも吟味した方がよい。

Digi-Key で H ブリッジを検索してそれを別のショップで調べてみる。そうすればほしい IC が Digi-Key の在庫に左右されずに使用できる。
試しに H ブリッジを Digi-Key で用途とパッケージで絞り込んで調べたところ、[このような一覧](https://docs.google.com/spreadsheets/d/1YwifbfS08Ro-1kxqgMN1l2ujk6fK_v7bKf-RipdZybw/edit?usp=sharing)が吐き出された。
- DRV8874 (野村先輩が使用している IC と同じもの)
- DRV8848
- DRV8220
さらに、このうち欲しい電流が吐き出せるのが [DRV8874 (野村先輩と同じ IC)] が選出される。<br>
ただ、この DRV8874 なのだが、Digi-Key, Mouser, RS Components, Akizuki, Marutsu のどれで調べても在庫切れ。もうダメじゃん...<br>
野村先輩の在庫と、評価ボードからパクればヨシッ！<br>

QFP と QFN
QFP はよく見る足が外に出たパッケージ、QFN は足が出てないパッケージ。リフローでしかつけられない奴が QFN 一応 9 号館でリフローできるらしい。
QFN にすればサイズ縮小できるし、条件に合った IC も見つかりやすいから良いんだけど、リフローする IC は一気にリフローする必要があるから、燃えたところだけ直すとかそういうことがやりにくい。
初めてなんだから回路は修正しやすいほうが良い。絶対 QFP がいいやろ。

###### Power MOSFET<br>
FET の耐圧（D-S 間電圧）と流したいドレイン電流（ID 電流）で大体の規格が絞れる。<br>
そこから、[ON 抵抗](https://www.rohm.co.jp/electronics-basics/transistors/tr_what9)と[スイッチング速度]()から、損失の大きさを計算してそれに耐えるものを選ぶ。<br>
DCX 10L 公称 4.5V の起動電流 1.55A で、これに 12V をかける。その時の電流値を考えて使う必要がある。<br>
- 別ディレクトリの Excel データによると ID = 3.06A (2S (8.9V)), 4.34A (3S (12.6V)) であることが算出された。3S 使うことも考えて、4.34A に耐えるものを選ぶようにすればよさそう。<br>
ついでに、配線幅については、右モータと左モータでひとつづつ使うことも考慮して設計する必要がある。よって上記条件によって 4.34mm 以上の配線幅となっていればよいことになる。<br>
- ON 抵抗については、パッケージが小さい方が ON 抵抗が大きく、パッケージが小さいと ON 抵抗が大きくなる。<br>
- 今回作る基板はサイズが比較的大きく、パッケージの違いによる大きさの違いは考慮しなくて良いと思う。よって ON 抵抗のより小さいものを選んでおけば良い。<br>
- [スイッチング速度についてはこのサイトが強そう](https://xtech.nikkei.com/atcl/learning/lecture/19/00080/00002/)<br>
digikey で以下の条件で絞り込んだ<br>
- Nch フルブリッジを内蔵したトランジスタアレイ IC<br>
- 部品状況：アクティブ<br>
- FET タイプ：N チャンネル 4 個 (H ブリッジ)<br>
- Vdss：24V 以上 (上条件適応後だと 30V 以上)<br>
- Id：9A 以上 (上条件適応後だと 13A 以上)<br>
- 取り付けタイプ：面実装<br>
以上の条件だとただ一つ [DMHT3006LFJ](https://www.diodes.com/assets/Datasheets/DMHT3006LFJ.pdf) のみに絞られた。<br>
トランジスタシングルの場合で絞り込んでみたい。<br>
FET で H ブリッジを組むことを考えてみる。<br>
絞り込み条件<br>
- Transistor - FET, MOSFET - Array<br>
- 部品状況 : Active<br>
- FET type : 2Nch (dual) | Nch \*2 (Half Bridge)<br>
- FET method : Logic Level Gate<br>
まずは上記で絞り込み、下記を追加<br>
- Vdss : 20V (大きすぎるとオン抵抗が大きくなる傾向がある。）<br>
- Id : 5A | 20A | 40A<br>
次に以上で絞り込み、「オン抵抗は小さいと電力が小さく済む」「ゲート電荷が小さいほうがスイッチング時のロスが減る（高速スイッチングができる）」「オン抵抗とゲート電荷はトレードオフ」という知識を以って、下記をさらに追加<br>
- <br>
モータの PWM 制御において「高速スイッチングができる」というのは大したメリットではないような気がした。なので「オン抵抗かゲート電荷か」については「オン抵抗」の方を取ることにする。<br>
因みに「チップサイズが大きい => オン抵抗が小さい => ゲート電荷が大きい」と、チップサイズとも関係がある様子。ただシャーシ基板だし、サイズはまだ考慮しなくていい気がする。<br>
「MOSFET の寄生容量・入力容量・出力容量・帰還容量 の関係」で一つ記事が書けるくらいの内容がある。（俺が俺に向けて知っておいてほしいことの一つ）<br>
このうちの 入力容量 が ゲート電荷 と直接的に関係があるもの。よって、ゲート電荷の大小を考えることは入力容量の大小を考えることと同じである。<br>
MOUSER で FET を調べてみる。<br>
- MOSFET SMD/SMT N-Channel MOSFET
- Rds On で昇順ソートして 2 ページまで CSV で吐き出す。
- Rds On が一番小さいのが [PSMN1R5-30BLEJ](https://www.mouser.jp/ProductDetail/Nexperia/PSMN1R5-30BLEJ?qs=1sbE9T7hb3ZypDkHrUdzRQ%3D%3D&utm_source=mouser-refine-download&utm_medium=file&utm_campaign=PSMN1R5-30BLEJ&utm_content=Nexperia) だった。ただ在庫が 5 しかあらん。
- 次に小さいのが [PSMN1R5-25YL,115](https://www.mouser.jp/ProductDetail/Nexperia/PSMN1R5-25YL115?qs=HnaUIVfgVjDTvZFUMaRG6Q%3D%3D&utm_source=mouser-refine-download&utm_medium=file&utm_campaign=PSMN1R5-25YL%2C115&utm_content=Nexperia) になった。こっちは在庫が 50 くらいある。これで良いんじゃね？いったんこれで考えてみる。
- 

***書き途中***

##### ラインセンサ
- 野村先輩によると、アナログ値を返すセンサと、ディジタル値を返すセンサの二種類がある。
- 試しに digikey で調べてみようとしたところ、『光センサ - フォトインタラプタ - スロットタイプ - トランジスタ出力』『光センサ - フォトインタラプタ - スロットタイプ - ロジック出力』という分類があり、トランジスタ出力が一般的なアナログ値を返すフォトインタラプタで、ロジック出力が野村先輩が言っていたディジタル値を返すセンサなのだろう。
- 接続する抵抗によって閾値を変更する。
- [なんかいい感じのサイト見つけた](https://components.omron.com/jp-ja/products/basic-knowledge/sensors/photomicro-sensors/technology)
- [こっちはフォトセンサの設計についてのサイト](https://toshiba-semicon-storage.com/content/dam/toshiba-ss/jp/docs/design-support/elearning/elearning_discrete05_r51.pdf)
勝手な予想混じりではあるが、メリットとデメリットについて考えてみる。<br>
アナログ出力のメリット<br>
- 環境が変わってもプログラム上で閾値を変更すればいいだけ<br>
アナログ出力のデメリット<br>
- ソースコードが長くなる
- 処理が重い<br>
デジタル出力のメリット<br>
- プログラム上でソートしてセンサ値を決める必要はない<br>
デジタル出力のデメリット<br>
- 環境が変わると閾値が変わる可能性がある（ポテンショメータを用いて閾値可変にするのも手だが沢山あるセンサのすべてにそれを適応するのは手間すぎるし重くなるしかさばるし）<br>
上記より、コースセンサ取得にはアナログセンサを用いて、サイドセンサ取得にはデジタルセンサを用いるというのはどうだろうか？<br>
適材適所な選び方ができている気がする。（気がする）<br>
コースラインの読み取りに使用するアナログセンサは、9号館でよく使用されるセンサ [TEMT7100X01](https://jp.rs-online.com/web/p/phototransistors/7000767) を使用することにする。どうしてこのセンサを使用しているのだろうか？？？下鳥先輩は「在庫が無くなったからノムさんに新しいの使ってもらってる（人柱）」とおっしゃっていた　が、「新しいセンサを使うことに対する抵抗がある」というのは、外乱の影響度とか、ロボトレとしての使用に向いているからとかそういう要件を満たしているからなのだろうか？
それと、わざわざメディアンフィルタしてラインを読むより、デジタルで値を出してくれた方がよいのではないか？という疑問に対して、「PID 制御を用いて車体を左右に振ることを考えたら、二値を取るよりも、もっと分解能の高いアナログセンサにした方がより滑らかに PID 制御してくれるゾ。」ということを教わった。
ただやはり、デジタルはノイズに強く、アナログはノイズに弱いらしい。そのノイズ対策のために、メディアムフィルタを使っている。
制御方法は二つ
- センサを右にあるやつと左にあるやつに分割して、左右それぞれの和で PID 制御する方法。
- 白を読み取っているセンサの角度からモータの出力をする方法。（ステアリング切らない限り、実はムズイらしい。）

##### IMU
まずは先輩方が使用している ICM-20648 を使用することにしてみる。
データシート用語
- ODR:Output Data Rate の略で、データを出力する周波数のこと。
I2C と SPI の違いとそれぞれの特徴。
いずれも同期式シリアル通信
SPI:SIMO SOMI SCLK SSn の四つ以上のピンでスレーヴを制御する。デバイスの数に応じて SS ピン（Slave Select ピン）が増えていくのでより多くのピンが必要になってしまう。
I2C:SDA SCL の二本線のみで制御することが可能だが、一般的に速度は SPI に劣ってしまう。プルアップ抵抗値 数百～数キロ Ω が必須。
速度の話をされてしまうと SPI でいいと思える。

##### UI
電子ブザーを付けたい。「電子ブザー」はアナログな電圧を印加することで音階を変化させることが可能。これは PWM 信号を用いて実効的に再現することができる。具体的には duty 比を変化させる。根拠は[ここ](https://smtengkapi.com/engineer-picbuzzer#toc4)。「圧電ブザー」の方も PWM で音階制御ができるが、周波数を変更する必要がある。ただそれだと Timer 全体の周波数が変更されてしまうから良くない。
左右旋回表示 LED
左右サブセンサデバッグ LED
導通 LED
リセット LED

操作系については、まず「何を操作したいのか」について考える。
- キャリブレーション（白と黒の色を確認）したい
- スタートボタンが欲しい
- ストップは自動で検出するようにすればいいのでストップボタンは必要ない
- 記憶したコースを走れるように、何回目のコース記録を引き出すか指定できるようにしたい。

##### CPU
先輩が STM32F405RGT6 を束買いしているので、とりあえずこれにするのはアリ。
クロック数とメモリと機能的に、ロボトレにいい塩梅で使えそうなのがこの CPU らしい。
SD カードを載せるか載せないかでマイコンを選択しているらしい。（野村先輩情報）
SD カードを載せたいのであれば STM32F446 で、内部フラッシュが使いたいならば STM32F405 を使うようだ。ちなみに、下鳥先輩からもらったマイコンボードは Nucleo-F446RE
446 は周波数が高く処理が速い。SD カードに書き込むことも可能だが、RAM がそこまで大きいわけじゃないので（小さすぎるわけでもない）、SD カードに書き込める本質的な量はそこまで大きくないことになる。
だったらフラッシュ使って 405 に記憶してしまっても良いんじゃない？
「デバッグのしやすさ、書き込みのしやすさ」という話については、ただ単純に「やり方」の問題で、
デバッガピンには SH コネクタを使うと、基板をより小さくできる。

***書き途中***

##### 電源回路
この電源回路を決めるのにレギュレータを選ぶ必要があるのだが、レギュレータの出力が決まらない以上は手の付けようがない。だからさっさとほかの回路作れ。電源選びは最後だ。

##### バッテリ
バッテリについて新たな知見を得たので記録しておく。気になったことは「結局バッテリは何 A まで流せるの？」ということで、いろいろ考えたり、ググったりしたところ、バッテリの容量（以下理論容量） Ah とは別に、C レートというものがあるようだ。C レートというのは、バッテリの理論容量を 1 / 何 時間で完全に放電するかという数値。例えば、2Ah の理論容量で、C レートが 1C と決められた場合は、2A を 1 / 1 時間で完全放電することができるというもの。2C の場合は 2A を 1 / 2 時間すなわち 30 分で放電しきることができるというもの。数式として扱うと、(最大放電電流 A) = (理論容量 Ah) * (C レート /h) で「結局バッテリに流せる電流」が求まる。<br>
今のところ機体に載せようと思っているバッテリは [Hyperion G5 SV 2S / 7.4V 50C 25~30C 240mAh](https://hyperion-world.com/en/p2661623-hp-g550-0240s2) なので、(最大連続放電電流) = 25~30 * 0.240 = 6~7.2A (最大瞬間放電電流) = 50 * 0.240 = 12A となり、結局バッテリには 12A までなら流すことができるということになる。安定化電源で電流制限をかける時はこの値を参考にして電流制限をかけるとよい。<br>

#### 現状決まっている部品を列挙していく
- メインセンサ : フォトトランジスタ [TEMT7100X01](https://jp.rs-online.com/web/p/phototransistors/7000767) 赤外線 LED [SIR19-21C/TR8](https://www.digikey.jp/ja/products/detail/everlight-electronics-co-ltd/SIR19-21C-TR8/2675916?s=N4IgTCBcDaIAQGUCSAlAjATgLRjQYQHoAVFADhAF0BfIA)
- サブセンサ : [S7136](https://akizukidenshi.com/catalog/g/gI-02425/)
- H ブリッジモータドライバ : [DRV8874PWPRCT](https://www.digikey.jp/ja/products/detail/texas-instruments/DRV8874PWPR/11502339?s=N4IgTCBcDaIAQBEBKA1AHGg7AFgAoHVckQBdAXyA) 及び それを搭載した評価ボード [DRV8874EVM](https://www.digikey.jp/ja/products/detail/texas-instruments/DRV8874EVM/10416576)
- モータコネクタ XA
- マイコン : [STM32F405RGTx](https://www.st.com/resource/en/datasheet/dm00037051.pdf)

タスク
- [x] CPU STM32H7 シリーズにしない理由を聞いてみる。裕ちゃんにマイコン選びを教えてもらう。在庫の関係上 446 か 405 になることは確定。
- [x] IMU ICM-20648 でいいと思うが、そもそも在庫があるのか確認する。QFPN パッケージしかヒットしないが、先輩たちはどうやってこの IC を基板に載せているのか見る。データシートを読んで理解してみようとする。> 基板に直でついてるんだけど、どうなってんの？？？リフローっぽい？
- [x] UI どんな操作ができるといいか先輩に聞く。
- [x] Conn どんなコネクタがあるのか 9 号館を見る。
- [x] Inventor の編集。基板二階建てにする。それにあたって下鳥先輩の VCM マシンを参考にバッテリの引き回しを見る。

KiCAD 設計中のメモ
VDC は 1.8 ~ 3.3V


